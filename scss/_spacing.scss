/* SPACING */

@use "vars";
@use "sass:map";
@use "sass:list";
@use "sass:math";

@mixin directions($prefix, $side, $size) {
    @if $side == "horiz" {
      #{$prefix}-left: $size;
      #{$prefix}-right: $size;
    } @else if $side == "vert" {
      #{$prefix}-top: $size;
      #{$prefix}-bottom: $size;
    } @else {
      #{$prefix}#{$side}: $size;
    }
}

@mixin expand-sizes($ext) {
  @each $type, $prefix in ("p": "padding", "m": "margin") {
    @each $letter, $side in map-merge($sides, $spans) {
      @for $x from 0 through calc(list.length($sizes) - 1) {
        $size: get-size($x);
        .#{$type}#{$letter}#{$x}#{$ext} {
          @include directions($prefix, $side, $size);
        }
        // negative margins
        @if $type == "m" and $x > 0 {
          .m#{$letter}#{$x}n#{$ext} {
            @include directions($prefix, $side, -$size);
          }
        }
      }
      .#{$type}#{$letter}-auto#{$ext} {
        @include directions($prefix, $side, auto);
      }
    }
  }
  @for $x from 0 through calc(list.length($sizes) - 1) {
    $size: get-size($x);
    .ga#{$x}#{$ext} {
      row-gap: $size;
      column-gap: $size;
    }
    .gv#{$x}#{$ext} { row-gap: $size; }
    .gh#{$x}#{$ext} { column-gap: $size; }
  }
  .mr-auto#{$ext} { margin-right: auto; }
  .ml-auto#{$ext} { margin-left:  auto; }
}

@include expand-sizes("");

@media #{$media-breakpoint-small} {
  @include expand-sizes("-s");
}

@media #{$media-breakpoint-medium} {
  @include expand-sizes("-m");
}

@media #{$media-breakpoint-large} {
  @include expand-sizes("-l");
}

.sgs { scrollbar-gutter: stable }
.sga { scrollbar-gutter: auto }

// add this to the actual breakpoint so that other -l, -m, etc kick in BEFORE
// the breakpoint is hit--this helps avoid the shrinking valley between the
// beginning of a breakpoint and the addition/removal of other elements like
// padding and margins. the gutter aligns with ph3/mh3

// only do 2-4 max view page
// common usage: "ph3 vp3-l"
@media (min-width: #{$breakpoint-large}) {
  .vp1-l, .vp2-l, .vp3-l {
    // The scrollbar is 1rem which is being counted in the overall width even
    // though it is uncontrollable. This scrollbar-gutter setting SHOULD remove
    // it from calculations, but it isn't... ces-la-vie
    scrollbar-gutter: stable both-edges;
    margin-left: auto;
    margin-right: auto;
  }
  @for $x from 2 through 4 {
    $maxwidth-gutter: #{list.nth($sizes, $x+1)*2};
    .vp#{$x}-l {
      max-width: #{calc(#{$breakpoint-large} - #{$maxwidth-gutter}rem)};
    }
  }
}
